<%# Renders a topic in the timeline view %>
<%# locals: (topic:) %>
<div class="px-5 py-4 hover:bg-base-50 transition-colors duration-150 <%= action_border_class(topic.action_taken) if topic.has_action? %>">
  <div class="flex items-start gap-4">
    <%# Action indicator %>
    <div class="flex-none pt-0.5">
      <% if topic.has_action? %>
        <%= action_badge(topic.action_taken) %>
      <% else %>
        <span class="badge badge-ghost badge-sm">
          <%= icon("minus", size: "w-3 h-3") %>
          No action
        </span>
      <% end %>
    </div>

    <%# Content %>
    <div class="flex-1 min-w-0">
      <%= render "shared/topic_content", topic: topic, show_inline_badge: false, truncate_summary: true %>

      <%# Metadata row %>
      <div class="flex flex-wrap items-center gap-3 mt-3 text-xs text-base-content/50">
        <span class="flex items-center gap-1">
          <%= icon("building-library", size: "w-3.5 h-3.5") %>
          <%= topic.governing_body&.name || "Unknown" %>
        </span>
        <%= link_to town_document_path(current_town, topic.document),
                    class: "flex items-center gap-1 hover:text-primary transition-colors" do %>
          <%= icon("document", size: "w-3.5 h-3.5") %>
          View document
        <% end %>
        <% if topic.action_taken_raw.present? && topic.has_action? %>
          <span class="flex items-center gap-1 italic">"<%= topic.action_taken_raw %>"</span>
        <% end %>
      </div>
    </div>
  </div>
</div>
